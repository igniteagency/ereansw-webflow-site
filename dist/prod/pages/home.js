"use strict";(()=>{var h=class{gapPct=.001;animDur=.8;autoDelay=5e3;alignOffsetPct=-2e-4;minFontPx=12;maxFontPx=18;pxRatio=.02;svg;path;progressCircle;group;schools;display;n;active=0;autoTimer=null;progressTween=null;L;baseStart;alignOffset;start;gap;circleLength;texts=[];textPaths=[];baseOffsets=[];resizeHandler;constructor(){let s=document.getElementById("hero-svg"),t=document.getElementById("textpath"),e=document.getElementById("progress-circle");if(!s||!(s instanceof SVGSVGElement))throw new Error("Required SVGSVGElement not found");if(!t||!(t instanceof SVGPathElement))throw new Error("Required SVGPathElement not found");if(!e||!(e instanceof SVGCircleElement))throw new Error("Required SVGCircleElement not found");this.svg=s,this.path=t,this.progressCircle=e,this.L=this.path.getTotalLength(),this.baseStart=this.L*.25,this.alignOffset=this.L*this.alignOffsetPct,this.start=this.baseStart+this.alignOffset,this.gap=this.L*this.gapPct,this.circleLength=this.progressCircle.getTotalLength(),this.progressCircle.style.strokeDasharray=this.circleLength.toString(),this.progressCircle.style.strokeDashoffset=this.circleLength.toString();let r=Array.from(document.querySelectorAll("#hero-school-list .hero_background_image-wrapper"));this.schools=r.map(i=>({name:i.dataset.schoolName||"",id:i.dataset.schoolId||"",element:i})),this.n=this.schools.length,this.display=[].concat(this.schools,this.schools,this.schools),this.active=this.n,this.group=document.createElementNS(this.svg.namespaceURI,"g"),this.group.id="schools-group",this.svg.appendChild(this.group),this.resizeHandler=this.onResize.bind(this),window.addEventListener("resize",this.resizeHandler),this.createTextElements(),this.renderDisplay(),this.alignActiveInstant(),this.animateProgress(),this.scheduleNext()}createTextElements(){for(;this.group.firstChild;)this.group.removeChild(this.group.firstChild);this.texts=[],this.textPaths=[];for(let s=0;s<this.display.length;s++){let t=document.createElementNS(this.svg.namespaceURI,"text");t.setAttribute("class","hero-svg-text"),t.style.cursor="pointer",t.addEventListener("click",()=>this.setActive(s));let e=document.createElementNS(this.svg.namespaceURI,"textPath");e.setAttribute("href","#textpath"),e.setAttribute("startOffset","0"),t.appendChild(e),this.group.appendChild(t),this.texts.push(t),this.textPaths.push(e)}}computeFontVB(){let t=window.innerWidth*this.pxRatio,e=Math.min(this.maxFontPx,Math.max(this.minFontPx,t)),i=this.svg.getBoundingClientRect().width;return e*100/i}renderDisplay(){let s=this.computeFontVB();window.IS_DEBUG_MODE&&console.debug("fontVB",s),this.group.style.fontSize=`${s}px`;for(let t=0;t<this.display.length;t++)this.textPaths[t].textContent=this.display[t].name;document.fonts.ready.then(()=>{requestAnimationFrame(()=>{let t=this.texts.map(n=>n.getComputedTextLength()),r=t.reduce((n,o)=>n+o,0)+this.gap*(this.display.length-1),a=this.start-r/2;this.baseOffsets=[];for(let n=0;n<this.display.length;n++){a+=t[n]/2;let o=(a+this.L)%this.L;this.textPaths[n].setAttribute("startOffset",o.toString()),this.baseOffsets.push(o),a+=t[n]/2+this.gap}window.IS_DEBUG_MODE&&console.debug("SVG text widths:",t),this.group.style.textAnchor="middle"})})}alignActive(){let s=this.baseOffsets[this.active],t=this.start-s;for(let e=0;e<this.display.length;e++){let r=(this.baseOffsets[e]+t+this.L)%this.L;gsap.to(this.textPaths[e],{attr:{startOffset:r},duration:this.animDur,ease:"power4.out"}),this.texts[e].classList.toggle("active",e===this.active)}this.updateActiveImage()}alignActiveInstant(){let s=this.baseOffsets[this.active],t=this.start-s;for(let e=0;e<this.display.length;e++){let r=(this.baseOffsets[e]+t+this.L)%this.L;this.textPaths[e].setAttribute("startOffset",r.toString()),this.texts[e].classList.toggle("active",e===this.active)}this.updateActiveImage()}updateActiveImage(){let s=this.active%this.n;for(let t=0;t<this.schools.length;t++)this.schools[t].element.classList.toggle("active",t===s)}animateProgress(){this.progressTween&&gsap.killTweensOf(this.progressCircle),this.progressCircle.style.strokeDashoffset=this.circleLength.toString(),this.progressTween=gsap.to(this.progressCircle,{strokeDashoffset:0,duration:this.autoDelay/1e3,ease:"none"})}scheduleNext(){this.autoTimer!==null&&clearTimeout(this.autoTimer),this.autoTimer=window.setTimeout(()=>this.setActive(this.active+1),this.autoDelay)}setActive(s){let{display:t,n:e,animDur:r}=this,i=t.length,a=(s%i+i)%i;this.active=a,this.alignActive(),this.animateProgress(),this.scheduleNext(),(a<e||a>=i-e)&&setTimeout(()=>{this.active=a<e?a+e:a-e,this.alignActiveInstant()},r*1e3)}onResize(){this.renderDisplay(),this.alignActiveInstant(),this.animateProgress()}destroy(){this.autoTimer!==null&&(clearTimeout(this.autoTimer),this.autoTimer=null),this.progressTween&&(gsap.killTweensOf(this.progressCircle),this.progressTween=null),window.removeEventListener("resize",this.resizeHandler),this.group.parentNode&&this.group.parentNode.removeChild(this.group);for(let s=0;s<this.schools.length;s++)this.schools[s].element.classList.remove("active")}};new h;})();
